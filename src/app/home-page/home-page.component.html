<!-- home-page.component.html -->
<div class="home-container">

    <!-- Title can be styled more -->
    <h1 class="main-title">ngx-category-search</h1>
  
    <!-- The search component - its width/centering is controlled by CSS below -->
       <!--
    Using the library component:
    - Bind data and required field names.
    - Bind optional configuration inputs.
    - Bind outputs to handler methods in HomePageComponent.
    - Provide a custom template for result items.
  -->
  <ncs-category-search
  [data]="initialDataForCategories"
  [searchResults]="searchData"
  [trackByIdField]="idField"
  [nameField]="displayNameField"
  [categoryField]="categoryGroupField"
  [friendlyIdField]="optionalFriendlyIdField"
  [placeholder]="customPlaceholder"
  [resultsBatchSize]="customBatchSize"
  [enableRecentSearches]="true"
  [showBottomShowAllButton]="true"
  [resultItemTemplate]="customResultItem"
  (searchRequested)="onSearchRequested($event)"
  (itemSelected)="onSearchResultSelected($event)"
  (recentSearchSelected)="onRecentSelected($event)"
  (categorySelected)="onCategorySelected($event)"
  (navigateToCategory)="onCategoryNavigate($event)"
  (navigateToAll)="onAllResultsNavigate($event)"
  (searchCleared)="onSearchCleared()"
  (searchTermChanged)="onTermChanged($event)"
  (dropdownVisibilityChanged)="onDropdownVisibilityChanged($event)"
  [showBottomShowAllButton]="false"
  ></ncs-category-search>

    <!-- *** NEW: Powered By Section *** -->
    <div class="powered-by-container">
      <div class="powered-by-animation">
          <!-- Simple geometric shapes for animation -->
          <div class="shape shape-1"></div>
          <div class="shape shape-2"></div>
          <div class="shape shape-3"></div>
      </div>
      <p class="powered-by-text">
          Search powered by <a href="https://www.npmjs.com/package/@r-ko/ngx-category-search" target="_blank" rel="noopener noreferrer">&#64;r-ko/ngx-category-search</a>
      </p>
  </div>
  <!-- *** END: Powered By Section *** -->
  
<!-- Replace the cards-container section with this: -->

<!-- Interactive Data Visualization -->
<div class="visualization-container">
  <h2 class="visualization-title">Search Data Visualization</h2>
  
  <!-- Search Flow Animation -->
  <div class="search-flow-animation">
    <div class="data-source">
      <div class="data-node" *ngFor="let i of [1,2,3,4,5,6,7,8]" 
           [class.highlight]="animationState.highlightedNodes.includes(i)">
        <div class="node-content">{{ getNodeLabel(i) }}</div>
      </div>
    </div>
    
    <div class="flow-connector">
      <div class="connector-line" [class.active]="animationState.flowActive"></div>
      <div class="pulse-dot" *ngFor="let i of [1,2,3]" 
           [class.active]="animationState.flowActive"></div>
    </div>
    
    <div class="result-container">
      <div class="result-item" *ngFor="let item of animationState.results"
           [class.fade-in]="true">
        <span class="result-icon">{{ getCategoryIcon(item.category) }}</span>
        <span class="result-text">{{ item.name }}</span>
      </div>
      <div class="empty-state" *ngIf="animationState.results.length === 0 && !animationState.loading">
        Type to search!
      </div>
      <div class="loading-indicator" *ngIf="animationState.loading">
        <div class="spinner"></div>
        <span>Processing...</span>
      </div>
    </div>
  </div>
  
  <!-- Interactive Controls -->
  <div class="search-controls">
    <div class="control-group">
      <button class="control-button" (click)="triggerAnimation('marutiSuzuki')">
        <span class="button-icon">ğŸš—</span> Maruti Suzuki
      </button>
      <button class="control-button" (click)="triggerAnimation('hyundai')">
        <span class="button-icon">ğŸš™</span> Hyundai
      </button>
      <button class="control-button" (click)="triggerAnimation('tata')">
        <span class="button-icon">ğŸšš</span> Tata
      </button>
    </div>
    <div class="info-text">
      <p>Click buttons above to see how search works across different car brands!</p>
    </div>
  </div>
</div>
  
  </div>

  <!-- ############################################# -->
<!--   Custom Template Definition for Result Items -->
<!-- ############################################# -->
<!-- Update the custom result item template -->
<ng-template #customResultItem let-item let-term="term">
  <!-- Custom rendering using the data item passed in context ($implicit = item) -->
  <span class="result-icon custom-icon" aria-hidden="true">
    <!-- Add logic here if you want different icons based on item[categoryGroupField] -->
  </span>

  <!-- Display friendly ID only if ID exists, otherwise show nothing here -->
  <span class="ncs-result-friendly-id" *ngIf="item.id !== null" [innerHTML]="getFriendlyId(item) | highlight: term"></span>

  <!-- Display details -->
  <div class="ncs-result-details" [ngClass]="{'full-width': item.id === null}">
    <!-- Use HighlightPipe from library -->
    <span class="ncs-result-name" [innerHTML]="item[displayNameField] | highlight: term"></span>
  </div>
</ng-template>

<!-- ############################################# -->
<!--   NEW: Custom Template Definition for Chiclets -->
<!-- ############################################# -->
<ng-template #customChiclet let-ctx>
  <!-- ctx: { category: string, count: number, isActive: boolean, type: 'initial' | 'results' } -->
  <button type="button"
          class="my-custom-chiclet"
          [class.active]="ctx.isActive"
          [disabled]="ctx.type === 'initial'"
          > <!-- REMOVED: (mousedown)="selectCategory(ctx.category, $event)" -->
    <!-- Example: Add an icon based on category -->
    <span class="chiclet-icon">
      {{ ctx.category === 'Maruti Suzuki' ? 'ğŸš—' : 
         ctx.category === 'Hyundai' ? 'ğŸš™' : 
         ctx.category === 'Renault' ? 'ğŸš˜' : 
         ctx.category === 'Toyota' ? 'ğŸš' : 
         ctx.category === 'Tata' ? 'ğŸšš' : 
         ctx.category === 'Mahindra' ? 'ğŸšœ' : 
         ctx.category === 'Honda' ? 'ğŸï¸' : 
         ctx.category === 'Kia' ? 'ğŸš—' : 
         ctx.category === 'MG' ? 'ğŸš“' : 
         ctx.category === 'Volkswagen' ? 'ğŸš•' : 
         ctx.category === 'Car Feature' ? 'ğŸ”§' : 'ğŸ”' }}
    </span>
    {{ ctx.category }}
    <span class="my-custom-chiclet-count">[{{ ctx.count }}]</span>
  </button>
</ng-template>